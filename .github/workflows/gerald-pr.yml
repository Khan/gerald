name: Gerald - Notify and Request Reviewers On Pull Request
'on':
 - pull_request
jobs:
  gerald:
    runs-on: ubuntu-latest
    steps:
      - name: Get All Changed Files
        uses: jaredly/get-changed-files@absolute
        id: changed
        with:
          format: 'json'
      - uses: allenevans/set-env@v2.0.0
        with:
          ALL_CHANGED_FILES: '${{ steps.changed.outputs.added_modified }}'
      - name: Check out base branch
        uses: actions/checkout@v2
        if: ${{ github.event.pull_request.draft == false }}
        with:
          ref: '${{ github.base_ref }}'
      - name: Check out head branch
        uses: actions/checkout@v2
        if: ${{ github.event.pull_request.draft == false }}
        with:
          ref: '${{ github.head_ref }}'
      - name: Run Gerald
        uses: Khan/gerald@05a3c2ca815344a3c96d6a63b25af8982e9b7f45
        if: ${{ github.event.pull_request.draft == false }}
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
          ADMIN_PERMISSION_TOKEN: '${{ secrets.KHAN_ACTIONS_BOT_TOKEN }}'
          EVENT: 'pull_request'
